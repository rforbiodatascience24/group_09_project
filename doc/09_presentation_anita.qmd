---
title: "09_presentation"
author: "Anita"
format: revealjs
editor: visual
execute:
  echo: false
---

## Microbiota differences in type 2 diabetes

s243116 - Andreis Marco

s243930 - Asiya Mohamad Yusuf Muse

s233426 - Magnus Harthimmer

s201190 - Anita Skovbjerg Hjort-Gregersen

s215024 - Rebecca Hjermind Millum

::: {.notes} Speaker notes go here. :::

## Hallmarks of diabetes

```{r}
# | echo: false
library("tidyverse")
library("here")
library("ggridges")
library("patchwork")
source("99_proj_func.R")
```

```{r}
# load data
# | echo: false
data_path <- "../data/06_dat_augmented.csv"
dataset <- read_csv(data_path, show_col_types = FALSE)
```

::: columns
::: {.column width="40%"}
Left column
:::

::: {.column width="60%"}
Right column
:::
:::

::: notes
Rebecca: Speaker notes go here.
:::

## Hallmarks of type 2 diabetes

::: columns
::: {.column width="50%"}
-   Type 1 and type 2 diabetes similarities and differences

```{r}
dataset|>
  filter(BMI_class != "Underweight") |> 
  ggplot(aes(x = BMI_class,
             y = `c-peptide`,
             fill = glucose_tolerance)) +
  geom_boxplot(position = position_dodge(
    preserve = "single"), 
    alpha = 0.4) +
  theme_minimal(base_size = 20) +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1,
                                   vjust = 1))+
    labs(x = "BMI class",
       y = "C-peptide [ng/mL]",
       title = "C-peptide Concentration",
       fill = "Glucose Tolerance: ")

```
:::

::: {.column width="50%"}
```{r}
dataset |> 
  ggplot(mapping = aes(x = fasting_insulin,
                      y = glucose_tolerance,
                      fill = glucose_tolerance )) +
    geom_density_ridges(alpha = 0.5) +
    labs(x = "Fasting Insulin",
         y = "Glucose Tolerance",
         title = "Fasting Insulin and Glucose Tolerance ") +
    theme_minimal(base_family = "Avenir",
                  base_size = 20) +
    theme(legend.position = "none")
```

```{r}
dataset|>
  filter(BMI_class != "Underweight") |> 
  filter(`gad-antibodies` < 20) |> 
  ggplot(aes(x = BMI_class,
             y = `gad-antibodies`,
             fill = glucose_tolerance)) +
  geom_boxplot(position = position_dodge(
    preserve = "single"), 
    alpha = 0.4) +
  theme_minimal(base_size = 20) +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1,
                                   vjust = 1))+
    labs(x = "BMI class",
       y = "GAD antibodies [ng/mL]",
       title = "GAD antibody concentration",
       fill = "Glucose Tolerance: ")
```
:::
:::

::: notes
Anita:

-   Type 1 and type 2 diabetes are similar in the features showed before, but very different in other characteristics

-   lets have a look at C-peptide, GAD antibodies and fasting insulin levels

-   GAD is not significant which is as expected because it is found in type 1 diabetes.
:::

## Treatment

::: columns
::: {.column width="50%"}
```{r}
#split on BMI
dataset |> 
  pivot_longer(cols = c(insulin, statins),
               names_to = "variable", 
               values_to = "category") |> 
  ggplot(aes(x = category, y = cholesterol, fill = category)) + 
  geom_boxplot(color = "black") + 
  facet_wrap(~variable) + 
  labs(
    x = "",
    y = "Cholesterol",
    title = "Cholesterol levels vs assuming insulin or statins"
  ) +
  facet_wrap(~BMI_class)+
  theme_minimal(base_size = 20) +
  theme(
    plot.title = element_text(size = 16, hjust = 0.5)
  )
```
:::

::: {.column width="50%"}
```{r}
#split on BMI
statins_cholesterol <- dataset |> 
  filter(BMI_class != "Underweight") |> 
  pivot_longer(cols = c(statins),
               names_to = "variable", 
               values_to = "category") |> 
  ggplot(aes(x = category, y = cholesterol, fill = category)) + 
  geom_boxplot(color = "black") +
  facet_wrap(~variable) +
  labs(
    x = "",
    y = "Cholesterol [mmol/L]",
    fill = "On statins"
  ) +
  facet_wrap(~glucose_tolerance) +
  theme_minimal(base_size = 20) +
  theme(
  )

save_plot_custom(
  plot = statins_cholesterol,
  filename = "07_statins_cholesterol.jpg"
)
statins_cholesterol
```

```{r}
linear_fasting_insuline_cholesterol <- dataset |> 
  filter(glucose_tolerance == "t2d") |> 
  ggplot(aes(x = fasting_insulin,
             y = cholesterol,
             colour = statins)) +
  geom_point(size = 2,
             alpha = 0.4) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "fasting_insulin [pmol/L]",
       y = "cholesterol[mmol/L]",
       title = "Fasting insulin vs hba1c groupt by statins for the type 2 diabect pationts",
       colour = "statins: ") +
  theme_minimal(base_size = 12)

save_plot_custom(
  plot = linear_fasting_insuline_cholesterol,
  filename = "07_linear_fasting_insuline_cholesterol.jpg"
)
linear_fasting_insuline_cholesterol
```

```{r}
statins_cholesterol
```
:::
:::

::: notes
Anita *Statins* - Statins inhibit the enzyme HMG-CoA reductase, which is essential for cholesterol production in the liver - Statins reduce the risk of cardiovascular related events such as heart attack, stroke, and death due to CVD.

*HbA1c* - is the glycated haemoglobin, - long lasting bloos glucose measurement

## 
:::
